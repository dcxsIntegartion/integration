<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Insert title here</title>

<!-- <script src="js/pidcrypt.js" /></script> -->
<!-- <script src="js/pidcrypt_util.js" /></script> -->
<!-- <script src="js/asn1.js" /></script> -->
<!-- <script src="js/jsbn.js" /></script> -->
<!-- <script src="js/rng.js" /></script> -->
<!-- <script src="js/prng4.js" /></script> -->
<!-- <script src="js/rsa.js" /></script> -->
<script src="js/jsrsasign-all-min.js" /></script>
<script src="js/keyutil-1.0.js" /></script>

</head>
<body>
<form name="form1">
<input id="a" value="1">
<input type="text" name="msgsigned" size="100" value="aaa"/><br/>
<textarea name="prvkey1" rows="10" cols="65">
-----BEGIN RSA PRIVATE KEY-----
MIICdgIBADANBgkqhkiG9w0BAQEFAASCAmAwggJcAgEAAoGBAJMKbnWSEoS4OaSYj9F3WMBapjAA6mflMTqZA4X8etYFE3uK2BUHOrS+xQtC+dCMbIlYW9tXDvre0X5BA4RtNVfHqceajGH1YKZHIOSDd9OLclY8NFDh0OIpyYHADTM9YkaQAx3MT89M8GyP9Mp5JpWpX8sxsHQApzC5dymTwOrNAgMBAAECgYATKkLndBiRz+lDeNcV+DZLLAWJMDVdQVQ/TP5Wkmf4SUUWzywG4aBXOp44L4ycEBF9fVTLq/c535zylcq9kfZnvTS7EhANoUOHQEeJil2ag+hmmcivOWpE8qxxH9AmcdJkqOzgVtWbWTFZYAJMF1vBqNEZTGKqxWGzl2x6sWZdAQJBAOdDIQMKo7WbawtE1BfET6gQn/M5/N9mFKEkBBxBqFbyb3eAN/Qcl8R9dxREGeHB/nJhjYH4G3by6oGs/L9ozyECQQCixPyUp+8ABTsepUkBkx8lKto+NdFHe3R+9GBxG7vAWbVPfUkcxaSJzodk7FOEKDOULP1ydp4viqW6J7yRLkItAkBuUnfNG6Y9XIcUOSF0tRHK+yNSxLb9W5U7yhKr6CaGU+EZAPGwYnOEKNZFtLckG4dmyWLYPaPcesWkVwG7ziQBAkEAiJobhELf4LuDHzgF6i1nkRDCsj0GUyB352f+XE6zJj3jXT+/EUeJzCGpHXj8qkf26Z9MYTjNjwakCXP53DnfTQJAdY0w477+RstaupdRL11W/UGfASKdJx34IF+jaUXXjWlsT3k8x8l5daW0JpSRWyFNnLo6OdpPdCOmk06mhN1MXQ==
-----END RSA PRIVATE KEY-----
</textarea><br/>
<select name="hashalg">
<option value="sha1" selected>SHA1
<option value="sha256">SHA256
<option value="sha512">SHA512
<option value="md5">MD5
<option value="ripemd160">RIPEMD-160
</select>
<input type="button" value="Sign to this message &darr;" onClick="doSign();"/><br/>
</form>
<script type="text/javascript">
var pubKey = "MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCZSDto7+FqOBiwEjyzjydWNw0tjcwDaBlQRMoH2t2nJtRlZltRYS8BLVpEZ2+3opikI4MrKmFbgTGq7oPGqRWvZpEeb0jydAqQ0V0rVeA6twHnnaCW8wCOrL+cjWcwJ6MR63p3uh0aSp/ALDNLVdYxCUhvuOPdRu/LHnM23NNmCwIDAQAB";

var privateKey  ="MIICWwIBAAKBgQDRhGF7X4A0ZVlEg594WmODVVUIiiPQs04aLmvfg8SborHss5gQXu0aIdUT6nb5rTh5hD2yfpF2WIW6M8z0WxRhwicgXwi80H1aLPf6lEPPLvN29EhQNjBpkFkAJUbS8uuhJEeKw0cE49g80eBBF4BCqSL6PFQbP9/rByxdxEoAIQIDAQABAoGAA9/q3Zk6ib2GFRpKDLO/O2KMnAfR+b4XJ6zMGeoZ7Lbpi3MW0Nawk9ckVaX0ZVGqxbSIX5Cvp/yjHHpww+QbUFrw/gCjLiiYjM9E8C3uAF5AKJ0r4GBPl4u8K4bpbXeSxSB60/wPQFiQAJVcA5xhZVzqNuF3EjuKdHsw+dk+dPECQQDubX/lVGFgD/xYuchz56Yc7VHX+58BUkNSewSzwJRbcueqknXRWwj97SXqpnYfKqZq78dnEF10SWsr/NMKi+7XAkEA4PVqDv/OZAbWr4syXZNv/Mpl4r5suzYMMUD9U8B2JIRnrhmGZPzLx23N9J4hEJ+Xh8tSKVc80jOkrvGlSv+BxwJAaTOtjA3YTV+gU7Hdza53sCnSw/8FYLrgc6NOJtYhX9xqdevbyn1lkU0zPr8mPYg/F84m6MXixm2iuSz8HZoyzwJARi2paYZ5/5B2lwroqnKdZBJMGKFpUDn7Mb5hiSgocxnvMkv6NjT66Xsi3iYakJII9q8CMa1qZvT/cigmdbAh7wJAQNXyoizuGEltiSaBXx4H29EdXNYWDJ9SS5f070BRbAIldqRh3rcNvpY6BKJqFapda1DjdcncZECMizT/GMrc1w==";
var privateKey8      =   "MIICdQIBADANBgkqhkiG9w0BAQEFAASCAl8wggJbAgEAAoGBANGEYXtfgDRlWUSDn3haY4NVVQiKI9CzThoua9+DxJuiseyzmBBe7Roh1RPqdvmtOHmEPbJ+kXZYhbozzPRbFGHCJyBfCLzQfVos9/qUQ88u83b0SFA2MGmQWQAlRtLy66EkR4rDRwTj2DzR4EEXgEKpIvo8VBs/3+sHLF3ESgAhAgMBAAECgYAD3+rdmTqJvYYVGkoMs787YoycB9H5vhcnrMwZ6hnstumLcxbQ1rCT1yRVpfRlUarFtIhfkK+n/KMcenDD5BtQWvD+AKMuKJiMz0TwLe4AXkAonSvgYE+Xi7wrhultd5LFIHrT/A9AWJAAlVwDnGFlXOo24XcSO4p0ezD52T508QJBAO5tf+VUYWAP/Fi5yHPnphztUdf7nwFSQ1J7BLPAlFty56qSddFbCP3tJeqmdh8qpmrvx2cQXXRJayv80wqL7tcCQQDg9WoO/85kBtavizJdk2/8ymXivmy7NgwxQP1TwHYkhGeuGYZk/MvHbc30niEQn5eHy1IpVzzSM6Su8aVK/4HHAkBpM62MDdhNX6BTsd3NrnewKdLD/wVguuBzo04m1iFf3Gp169vKfWWRTTM+vyY9iD8XziboxeLGbaK5LPwdmjLPAkBGLalphnn/kHaXCuiqcp1kEkwYoWlQOfsxvmGJKChzGe8yS/o2NPrpeyLeJhqQkgj2rwIxrWpm9P9yKCZ1sCHvAkBA1fKiLO4YSW2JJoFfHgfb0R1c1hYMn1JLl/TvQFFsAiV2pGHetw2+ljoEomoVql1rUON1ydxkQIyLNP8YytzX"; 
var privateKey2 ="MIICdgIBADANBgkqhkiG9w0BAQEFAASCAmAwggJcAgEAAoGBAJlIO2jv4Wo4GLASPLOPJ1Y3DS2NzANoGVBEygfa3acm1GVmW1FhLwEtWkRnb7eimKQjgysqYVuBMarug8apFa9mkR5vSPJ0CpDRXStV4Dq3AeedoJbzAI6sv5yNZzAnoxHrene6HRpKn8AsM0tV1jEJSG+4491G78seczbc02YLAgMBAAECgYBBzwI6vmqP+P+YcGwBR1/DIyWUPkGt4L6leLMohi4Nup0L39Mq8EeHANq1bZdIRxWzus9w8+QSrjgNxBNtcmCtXhDx04T3DPDvKcQB39twf0N73Z/0Jj6P6+lwuk187+BjxEzRAT1p0mYBrlK5W4Urnl/BkMUbMhXXtEW+PJmFaQJBAOrhMEYBCievq1DS5yhUWpgJ6hVwUrIuo3aMeNFbrh2qZwQQRCqp5b1VHCR761WGny2C/qSp61iqtcnj7razJt0CQQCnELXY73K6+Qr7HIQtR5kqbHdUmkOrSpkA/5wgSdtRUUw6vcH+jh4bp6SsUd4jbPTFS4GdcP/Zdiu4ZEdIDk4HAkBCN3IQikJ+pbu6cXrRl9ZifokLujrWGOfkh/2XqC0SF/Qq5RsSnAs0sUXZ00WpOuatQfzgFzdOK/JMFII7543RAkAUVQxMoper+bNEbGwJtrUFXL4JJd0mc6W7YWB27YYrl2FXpNB/UnyHkReRgUUvuorvmAjmSGJa7O7VOh8SverxAkEAgWBIRZ3r18loGNkp7dEZpA+disVbHWKcMavwM1CNh+BuYboPd4+DayGoCvLv1J/jDIVuT7cMzDjw3dDgDtdPWQ==";
var key4        ="MIICdgIBADANBgkqhkiG9w0BAQEFAASCAmAwggJcAgEAAoGBAJMKbnWSEoS4OaSYj9F3WMBapjAA6mflMTqZA4X8etYFE3uK2BUHOrS+xQtC+dCMbIlYW9tXDvre0X5BA4RtNVfHqceajGH1YKZHIOSDd9OLclY8NFDh0OIpyYHADTM9YkaQAx3MT89M8GyP9Mp5JpWpX8sxsHQApzC5dymTwOrNAgMBAAECgYATKkLndBiRz+lDeNcV+DZLLAWJMDVdQVQ/TP5Wkmf4SUUWzywG4aBXOp44L4ycEBF9fVTLq/c535zylcq9kfZnvTS7EhANoUOHQEeJil2ag+hmmcivOWpE8qxxH9AmcdJkqOzgVtWbWTFZYAJMF1vBqNEZTGKqxWGzl2x6sWZdAQJBAOdDIQMKo7WbawtE1BfET6gQn/M5/N9mFKEkBBxBqFbyb3eAN/Qcl8R9dxREGeHB/nJhjYH4G3by6oGs/L9ozyECQQCixPyUp+8ABTsepUkBkx8lKto+NdFHe3R+9GBxG7vAWbVPfUkcxaSJzodk7FOEKDOULP1ydp4viqW6J7yRLkItAkBuUnfNG6Y9XIcUOSF0tRHK+yNSxLb9W5U7yhKr6CaGU+EZAPGwYnOEKNZFtLckG4dmyWLYPaPcesWkVwG7ziQBAkEAiJobhELf4LuDHzgF6i1nkRDCsj0GUyB352f+XE6zJj3jXT+/EUeJzCGpHXj8qkf26Z9MYTjNjwakCXP53DnfTQJAdY0w477+RstaupdRL11W/UGfASKdJx34IF+jaUXXjWlsT3k8x8l5daW0JpSRWyFNnLo6OdpPdCOmk06mhN1MXQ==";
// var key = pidCryptUtil.decodeBase64(pubKey);
// var rsa = new pidCrypt.RSA();
// var asn = pidCrypt.ASN1.decode(pidCryptUtil.toByteArray(key));
// var tree = asn.toHexTree();
// rsa.setPublicKeyFromASN(tree);
// encryptBase64("123", rsa);

function doSign() {
// 	var key = pidCryptUtil.decodeBase64();
// 	alert(KEYUTIL.getKey("-----BEGIN RSA PRIVATE KEY-----"+privateKey+"-----END RSA PRIVATE KEY-----","PKCS8PRV"));
	  var rsa = new RSAKey();
	      rsa =KEYUTIL.getKey("-----BEGIN PRIVATE KEY-----"+privateKey2+"-----END PRIVATE KEY-----");
	  var hashAlg = document.form1.hashalg.value;
	  alert(hashAlg);
	  var hSig = rsa.signString(document.form1.msgsigned.value, hashAlg);
	  alert(linebrk(hSig, 64));
	}
	
// var sig = new KJUR.crypto.Signature({"alg": "MD5withRSA", "prov": "cryptojs/jsrsa"}); // alg为MD5WithRSA，这个还有个常见的是SHA1WithRSA，不过貌似支付宝是用的MD5，所以我们公司用的也是MD5，也许java默认的就是这个格式。  
// sig.initSign(privateKey);  // 设置key  
// sig.signString("123");  // 签名  
// var sign = hex2b64(s4.hSign);  // 得到签名Hex，并转成base64string  

//alert();
</script>
</body>
</html>