/**
* jQuery.bsgrid v1.35 by @Baishui2004
* Copyright 2014 Apache v2 License
* https://github.com/baishui2004/jquery.bsgrid
*/
(function(a){a.fn.bsgrid.defaults.extend.settings={supportGridEdit:false,supportGridEditTriggerEvent:"rowClick",supportColumnMove:false,searchConditionsContainerId:"",fixedGridHeader:false,fixedGridHeight:"320px"};a.fn.bsgrid.defaults.colsProperties.lineNumberAttr="w_num";a.fn.bsgrid.defaults.colsProperties.checkAttr="w_check";a.fn.bsgrid.defaults.colsProperties.editAttr="w_edit";a.fn.bsgrid.defaults.colsProperties.aggAttr="w_agg";a.fn.bsgrid.extendInitGrid={};a.fn.bsgrid.extendBeforeRenderGrid={};a.fn.bsgrid.extendRenderPerRow={};a.fn.bsgrid.extendRenderPerColumn={};a.fn.bsgrid.extendAfterRenderGrid={};a.fn.bsgrid.extendOtherMethods={};a.bsgrid.forcePushPropertyInObject(a.fn.bsgrid.defaults.extend.initGridMethods,"initGridOptions",function(b,c){var d=c.columnsModel;a.fn.bsgrid.getGridHeaderObject(c).each(function(e){d[e].lineNumber=a.trim(a(this).attr(c.settings.colsProperties.lineNumberAttr));d[e].check=a.trim(a(this).attr(c.settings.colsProperties.checkAttr));d[e].edit=a.trim(a(this).attr(c.settings.colsProperties.editAttr))});if(a("#"+c.gridId+" tfoot tr td["+c.settings.colsProperties.aggAttr+"!='']").length!=0){a("#"+c.gridId+" tfoot tr td").each(function(f){d[f].aggName="";d[f].aggIndex="";var e=a.trim(a(this).attr(c.settings.colsProperties.aggAttr));if(e.length!=0){var g=e.split(",");d[f].aggName=g[0].toLocaleLowerCase();d[f].aggIndex=g.length>1?g[1]:""}})}if(a("#"+c.gridId+" thead tr:last th["+c.settings.colsProperties.checkAttr+"!='']").length==0){delete c.settings.extend.initGridMethods.initGridCheck;delete c.settings.extend.renderPerColumnMethods.renderCheck;delete c.settings.extend.afterRenderGridMethods.addCheckChangedEvent}if(!c.settings.extend.settings.supportGridEdit){delete c.settings.extend.renderPerColumnMethods.renderForm;delete c.settings.extend.afterRenderGridMethods.addGridEditEvent}if(!c.settings.extend.settings.supportColumnMove){delete c.settings.extend.initGridMethods.initColumnMove}if(!c.settings.extend.settings.fixedGridHeader){delete c.settings.extend.initGridMethods.fixedHeader;delete c.settings.extend.afterRenderGridMethods.fixedHeader}if(a.trim(c.settings.extend.settings.searchConditionsContainerId)==""){delete c.settings.extend.initGridMethods.initSearchConditions}if(a("#"+c.gridId+" tfoot td["+c.settings.colsProperties.aggAttr+"!='']").length==0){delete c.settings.extend.afterRenderGridMethods.aggregation}});a.fn.bsgrid.extendOtherMethods.fixedHeader=function(b,c){if(a.trim(a("#"+c.gridId+"_fixedDiv").data("fixedGridLock"))=="lock"){return}a("#"+c.gridId+"_fixedDiv").data("fixedGridLock","lock");var e=a("#"+c.gridId+" thead tr").length;if(!b){e=e/2;a("#"+c.gridId+" thead tr:lt("+e+")").remove()}var d=f(c.settings.extend.settings.fixedGridHeight);if(d<a("#"+c.gridId).height()){a("#"+c.gridId+"_fixedDiv").height(d);a("#"+c.gridId).width(a("#"+c.gridId+"_fixedDiv").width()-18);a("#"+c.gridId+"_fixedDiv").animate({scrollTop:"0px"},0)}else{a("#"+c.gridId+"_fixedDiv").height(a("#"+c.gridId).height());a("#"+c.gridId).width(a("#"+c.gridId+"_fixedDiv").width()-1)}a("#"+c.gridId+" thead tr:lt("+e+")").clone(true).prependTo("#"+c.gridId+" thead");a("#"+c.gridId+" thead tr:lt("+e+")").css({"z-index":10,position:"fixed"}).width(a("#"+c.gridId+" thead tr:last").width());a("#"+c.gridId+" thead tr:lt("+e+")").each(function(h){var g=a("#"+c.gridId+" thead tr:eq("+(e+h)+")").position();a(this).css({top:g.top-f(a(this).find("th").css("border-top-width")),left:g.left})});a("#"+c.gridId+" thead tr:gt("+(e-1)+")").each(function(g){a(this).find("th").each(function(j){var h=a(this);a("#"+c.gridId+" thead tr:eq("+g+") th:eq("+j+")").height(h.height()+((g==e-1)?2:1)*f(h.css("border-top-width"))).width(h.width()+f(h.css("border-left-width")))})});a("#"+c.gridId+"_fixedDiv").data("fixedGridLock","");function f(h){h=a.trim(h).toLowerCase().replace("px","");var g=parseFloat(h);return isNaN(g)?0:g}};a.bsgrid.forcePushPropertyInObject(a.fn.bsgrid.defaults.extend.initGridMethods,"fixedHeader",function(b,c){a("#"+b).wrap('<div id="'+b+'_fixedDiv"></div>');a("#"+b+"_fixedDiv").data("fixedGridLock","");a("#"+b+"_fixedDiv").css({padding:0,"border-width":0,width:"98%","overflow-y":"auto","margin-bottom":"-1px"});a("#"+b).css({width:"auto"});a("#"+b+"_pt_outTab").css({"border-top-width":"1px"});a.fn.bsgrid.extendOtherMethods.fixedHeader(true,c);a(window).resize(function(){a.fn.bsgrid.extendOtherMethods.fixedHeader(false,c)})});a.bsgrid.forcePushPropertyInObject(a.fn.bsgrid.defaults.extend.afterRenderGridMethods,"fixedHeader",function(d,c,b){a.fn.bsgrid.extendOtherMethods.fixedHeader(false,b)});a.fn.bsgrid.extendInitGrid.bindExtendMethods=function(b,c){var d=a.fn.bsgrid.getGridObj(b);if(a("#"+c.gridId+" thead tr:last th["+c.settings.colsProperties.checkAttr+"!='']").length!=0){d.getCheckedRowsIndexs=function(){return a.fn.bsgrid.defaults.extend.getCheckedRowsIndexs(c)};d.getCheckedRowsRecords=function(){return a.fn.bsgrid.defaults.extend.getCheckedRowsRecords(c)}}if(c.settings.extend.settings.supportGridEdit){d.activeGridEditMode=function(){return a.fn.bsgrid.defaults.extend.activeGridEditMode(c)};d.getChangedRowsIndexs=function(){return a.fn.bsgrid.defaults.extend.getChangedRowsIndexs(c)};d.getChangedRowsOldRecords=function(){return a.fn.bsgrid.defaults.extend.getChangedRowsOldRecords(c)};d.getRowsChangedColumnsValue=function(){return a.fn.bsgrid.defaults.extend.getRowsChangedColumnsValue(c)}}};a.bsgrid.forcePushPropertyInObject(a.fn.bsgrid.defaults.extend.initGridMethods,"bindExtendMethods",a.fn.bsgrid.extendInitGrid.bindExtendMethods);a.fn.bsgrid.extendInitGrid.initGridCheck=function(b,c){a.fn.bsgrid.getGridHeaderObject(c).each(function(d){if(c.columnsModel[d].check=="true"){if(a.trim(a(this).html())==""){a(this).html('<input class="bsgrid_editgrid_check" type="checkbox"/>')}a(this).find("input[type=checkbox]").change(function(){var e=a.bsgrid.adaptAttrOrProp(a(this),"checked")?true:false;a.bsgrid.adaptAttrOrProp(a("#"+b+" tbody tr td:nth-child("+(d+1)+")>input[type=checkbox]"),"checked",e)})}})};a.bsgrid.forcePushPropertyInObject(a.fn.bsgrid.defaults.extend.initGridMethods,"initGridCheck",a.fn.bsgrid.extendInitGrid.initGridCheck);a.fn.bsgrid.extendInitGrid.initSearchConditions=function(b,c){var e=new StringBuilder();e.append('<select class="bsgrid_conditions_select">');var f={};a.fn.bsgrid.getGridHeaderObject(c).each(function(h){var g=c.columnsModel[h].index;var j=a.trim(a(this).text());if(g!=""&&j!=""&&a.trim(f[g])==""){f[g]=j}});for(var d in f){e.append('<option value="'+d+'">'+f[d]+"</option>")}e.append("</select>");e.append("&nbsp;");e.append('<input type="text" class="bsgrid_conditions_input" />');a("#"+c.settings.extend.settings.searchConditionsContainerId).html(e.toString());a("#"+c.settings.extend.settings.searchConditionsContainerId+" select.bsgrid_conditions_select").change(function(){a(this).next("input.bsgrid_conditions_input").attr("name",a(this).val())}).trigger("change")};a.bsgrid.forcePushPropertyInObject(a.fn.bsgrid.defaults.extend.initGridMethods,"initSearchConditions",a.fn.bsgrid.extendInitGrid.initSearchConditions);a.fn.bsgrid.extendInitGrid.initColumnMove=function(c,d){if(a("#"+d.gridId+" thead tr").length!=1){return}a("#"+d.gridId).css({"table-layout":"fixed"});var e=a.fn.bsgrid.getGridHeaderObject(d);var b=e.length;e.each(function(g){var h=this;a(h).mousedown(function(){f(h,g,b)});a(h).mousemove(function(){var q=a(h).offset().left;var n=0,o=0;if(g!=b-1){n=a(h).next();o=n.offset().left}var p=h;if(g!=b-1&&event.clientX-o>-10){p=n}if((g!=0&&event.clientX-q<10)||(g!=b-1&&event.clientX-o>-10)){a(h).css({cursor:"e-resize"});if(a.trim(a(h).data("ex_mousedown"))!="mousedown"){return}var l=a(p).width();var m=l-event.clientX+a(p).offset().left;var k=a(p).prev().width();var i=k+event.clientX-a(p).offset().left;if(parseInt(m)>19&&parseInt(i)>19){a(p).width(m).prev().width(i)}}else{a(p).css({cursor:"default"});j(h,g,b)}});a(h).mouseup(function(){j(h,g,b)});a(h).mouseout(function(){var i=a(h).offset();if(i.top>event.clientY||i.top+a(h).height()<event.clientY){j(h,g,b)}});function f(m,l,k){if(l!=0){a(m).prev().data("ex_mousedown","mousedown")}a(m).data("ex_mousedown","mousedown");if(l!=k-1){a(m).next().data("ex_mousedown","mousedown")}}function j(m,l,k){if(l!=0){a(m).prev().data("ex_mousedown","")}a(m).data("ex_mousedown","");if(l!=k-1){a(m).next().data("ex_mousedown","")}}})};a.bsgrid.forcePushPropertyInObject(a.fn.bsgrid.defaults.extend.initGridMethods,"initColumnMove",a.fn.bsgrid.extendInitGrid.initColumnMove);a.fn.bsgrid.extendRenderPerColumn.renderCheck=function(b,h,d,e,g,c){if(h<c.curPageRowsNum){var f=c.columnsModel[d];if(f.check=="true"){return'<input class="bsgrid_editgrid_check" type="checkbox" value="'+a.fn.bsgrid.getRecordIndexValue(b,f.index,c)+'"/>'}}return false};a.bsgrid.forcePushPropertyInObject(a.fn.bsgrid.defaults.extend.renderPerColumnMethods,"renderCheck",a.fn.bsgrid.extendRenderPerColumn.renderCheck);a.fn.bsgrid.extendRenderPerColumn.renderForm=function(c,f,i,b,e,j){if(f<j.curPageRowsNum){var d=j.columnsModel[i];var h=d.edit;var g=a.fn.bsgrid.getRecordIndexValue(c,d.index,j);if(h=="checkbox"){return g+'<input class="bsgrid_editgrid_hidden bsgrid_editgrid_checkbox" type="'+h+'" value="'+g+'"/>'}else{if(h=="text"||h=="hidden"||h=="password"||h=="radio"||h=="button"){return g+'<input class="bsgrid_editgrid_hidden bsgrid_editgrid_edit" type="'+h+'" value="'+g+'"/>'}else{if(h=="textarea"){return g+'<textarea class="bsgrid_editgrid_hidden bsgrid_editgrid_edit">'+g+"</textarea>"}}}}return false};a.bsgrid.forcePushPropertyInObject(a.fn.bsgrid.defaults.extend.renderPerColumnMethods,"renderForm",a.fn.bsgrid.extendRenderPerColumn.renderForm);a.bsgrid.forcePushPropertyInObject(a.fn.bsgrid.defaults.extend.afterRenderGridMethods,"renderLineNumber",function(d,c,b){a.fn.bsgrid.getGridHeaderObject(b).each(function(f){var e=b.columnsModel[f].lineNumber;if(e=="line"||e=="total_line"){a("#"+b.gridId+" tbody tr:lt("+b.curPageRowsNum+") td:nth-child("+(f+1)+")").each(function(g){a(this).html((e=="line")?(g+1):(g+b.startRow))})}})});a.fn.bsgrid.extendAfterRenderGrid.addCheckChangedEvent=function(d,c,b){a.fn.bsgrid.getGridHeaderObject(b).each(function(e){if(b.columnsModel[e].checkAttr=="true"){var g=a(this).find("input[type=checkbox]");var f=a("#"+b.gridId+" tbody tr td:nth-child("+(e+1)+")>input[type=checkbox]");f.change(function(){var h=a.bsgrid.adaptAttrOrProp(g,"checked")?true:false;if(!h&&f.filter(":checked").length==f.length){a.bsgrid.adaptAttrOrProp(g,"checked",true)}else{if(h&&f.filter(":checked").length!=f.length){a.bsgrid.adaptAttrOrProp(g,"checked",false)}}})}})};a.bsgrid.forcePushPropertyInObject(a.fn.bsgrid.defaults.extend.afterRenderGridMethods,"addCheckChangedEvent",a.fn.bsgrid.extendAfterRenderGrid.addCheckChangedEvent);a.fn.bsgrid.extendAfterRenderGrid.addGridEditEvent=function(e,c,b){a("#"+b.gridId+" tbody tr:lt("+b.curPageRowsNum+")").each(function(f){var g=this;var h=b.columnsModel;a(g).find("td").each(function(i){if(h[i].edit!=""){a(this).find(".bsgrid_editgrid_checkbox, .bsgrid_editgrid_edit").change(function(){if(a.trim(a(this).val())!=a.fn.bsgrid.getGridObj(b.gridId).getColumnValue(f,h[i].index)){a(this).addClass("bsgrid_editgrid_change")}else{a(this).removeClass("bsgrid_editgrid_change")}a(g).data("change",a(g).find(".bsgrid_editgrid_change").length)})}});if(b.settings.extend.settings.supportGridEditTriggerEvent==""){a(this).find(".bsgrid_editgrid_hidden").each(function(){d(this)})}else{if(b.settings.extend.settings.supportGridEditTriggerEvent=="rowClick"){a(this).click(function(){a(this).find(".bsgrid_editgrid_hidden").each(function(){d(this)})})}else{if(b.settings.extend.settings.supportGridEditTriggerEvent=="rowDoubleClick"){a(this).dblclick(function(){a(this).find(".bsgrid_editgrid_hidden").each(function(){d(this)})})}else{if(b.settings.extend.settings.supportGridEditTriggerEvent=="cellClick"){a(this).find(".bsgrid_editgrid_hidden").each(function(){var i=this;a(i).parent("td").click(function(){d(i)})})}else{if(b.settings.extend.settings.supportGridEditTriggerEvent=="cellDoubleClick"){a(this).find(".bsgrid_editgrid_hidden").each(function(){var i=this;a(i).parent("td").dblclick(function(){d(i)})})}}}}}});function d(f){var g=a(f).removeClass("bsgrid_editgrid_hidden").clone(true);a(f).parent("td").html(g)}};a.bsgrid.forcePushPropertyInObject(a.fn.bsgrid.defaults.extend.afterRenderGridMethods,"addGridEditEvent",a.fn.bsgrid.extendAfterRenderGrid.addGridEditEvent);a.fn.bsgrid.extendAfterRenderGrid.aggregation=function(f,c,b){var e=a.fn.bsgrid.getGridObj(b.gridId);var d=b.columnsModel;a("#"+b.gridId+" tfoot tr td["+b.settings.colsProperties.aggAttr+"!='']").each(function(g){if(d[g].aggName!=""){var k=d[g].aggName;var j=null;if(k=="count"){j=b.curPageRowsNum}else{if(k=="countnotnone"||k=="sum"||k=="avg"||k=="max"||k=="min"||k=="concat"){if(k=="countnotnone"){j=0}var h=new StringBuilder();a("#"+b.gridId+" tbody tr:lt("+b.curPageRowsNum+")").each(function(i){var l=e.getColumnValue(i,d[g].aggIndex);if(l==""){}else{if(k=="countnotnone"){j=(j==null?0:j)+1}else{if(k=="sum"||k=="avg"){if(!isNaN(l)){j=(j==null?0:j)+parseFloat(l)}}else{if(k=="max"||k=="min"){if(!isNaN(l)&&(j==null||(k=="max"&&parseFloat(l)>j)||(k=="min"&&parseFloat(l)<j))){j=parseFloat(l)}}else{if(k=="concat"){h.append(l)}}}}}});if(k=="avg"&&j!=null){j=j/b.curPageRowsNum}else{if(k=="concat"){j=h.toString()}}}}j=j==null?"":j;a(this).html(j)}})};a.bsgrid.forcePushPropertyInObject(a.fn.bsgrid.defaults.extend.afterRenderGridMethods,"aggregation",a.fn.bsgrid.extendAfterRenderGrid.aggregation);a.fn.bsgrid.defaults.extend.getCheckedRowsIndexs=function(b){var c=[];a("#"+b.gridId+" tbody tr").each(function(d){if(a(this).find("td>input:checked").length==1){c[c.length]=d}});return c};a.fn.bsgrid.defaults.extend.getCheckedRowsRecords=function(c){var b=[];a.each(a.fn.bsgrid.defaults.extend.getCheckedRowsIndexs(c),function(d,e){b[b.length]=a.fn.bsgrid.getRecord(e,c)});return b};a.fn.bsgrid.defaults.extend.activeGridEditMode=function(b){if(!b.settings.extend.settings.supportGridEdit){return}a("#"+b.gridId+" tbody tr:lt("+b.curPageRowsNum+") td .bsgrid_editgrid_hidden").each(function(){var c=a(this).removeClass("bsgrid_editgrid_hidden").clone(true);a(this).parent("td").html(c)})};a.fn.bsgrid.defaults.extend.getChangedRowsIndexs=function(b){var c=[];a("#"+b.gridId+" tbody tr").each(function(d){var e=a.trim(a(this).data("change"));if(!isNaN(e)&&parseInt(e)>0){c[c.length]=d}});return c};a.fn.bsgrid.defaults.extend.getChangedRowsOldRecords=function(c){var b=[];a.each(a.fn.bsgrid.defaults.extend.getChangedRowsIndexs(c),function(d,e){b[b.length]=a.fn.bsgrid.getRecord(e,c)});return b};a.fn.bsgrid.defaults.extend.getRowsChangedColumnsValue=function(c){var b={};a.each(a.fn.bsgrid.defaults.extend.getChangedRowsIndexs(c),function(d,e){b["row_"+e]={};a("#"+c.gridId+" tbody tr:eq("+e+") td").each(function(f){if(a(this).find(".bsgrid_editgrid_change").length>0){b["row_"+e][c.columnsModel[f].index]=a(this).find(".bsgrid_editgrid_change").val()}})});return b}})(jQuery);